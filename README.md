
# 📘 Device Management API Documentation

## 📂 Overview

This REST API manages electronic devices, their brands, and availability states.

* Devices belong to brands.
* Devices have states like `AVAILABLE`, `IN_USE`, or `INACTIVE`.
* The API allows creating, reading, updating, and deleting devices with proper business validation.

---

## 🧠 Business Rules

* `created` timestamp cannot be modified after creation.
* If a device is `IN_USE`, its `name` and `brand` cannot be updated.
* Devices in the `IN_USE` state cannot be deleted.

---

## 📦 Data Models

### `DeviceDTO`

```json
{
  "id": 1,
  "name": "SuperMouse",
  "brand": "Logitech",
  "state": "AVAILABLE",
  "created": "2025-08-02T16:00:00"
}
```

* `id`: Long (autogenerated)
* `name`: String (device name)
* `brand`: String (brand name, created if doesn't exist)
* `state`: Enum (AVAILABLE, IN\_USE, INACTIVE)
* `created`: LocalDateTime (timestamp of creation)

---

## 🚀 Endpoints

All endpoints are prefixed with: `/device`

### ✅ `GET /device/hello`

Health check.

```http
Response: 200 OK
"Service UP"
```

---

### ➕ `POST /device`

Create a new device.

**Request JSON:**

```json
{
  "name": "Zbysiophone",
  "brand": "Siemens",
  "state": "AVAILABLE",
  "created": "2025-08-02T16:00:00"
}
```

**Response:**

```json
{
  "id": 5,
  "name": "Zbysiophone",
  "brand": "Siemens",
  "state": "AVAILABLE",
  "created": "2025-08-02T16:00:00"
}
```

---

### 🔁 `PUT /device/{id}`

Update an existing device.
Business logic will:

* preserve the `created` timestamp,
* ignore changes to `name` and `brand` if the device is `IN_USE`.

**Request JSON:**

```json
{
  "name": "NewName",
  "brand": "NewBrand",
  "state": "INACTIVE",
  "created": "2027-01-01T00:00:00"
}
```

**Response JSON (if current state is IN\_USE):**

```json
{
  "id": 5,
  "name": "Zbysiophone",      // name preserved
  "brand": "Siemens",         // brand preserved
  "state": "IN_USE",
  "created": "2025-08-02T16:00:00"  // not modified
}
```

---

### 🔍 `GET /device/{id}`

Get a single device by ID.

```http
GET /device/5
```

**Response:**

```json
{
  "id": 5,
  "name": "Zbysiophone",
  "brand": "Siemens",
  "state": "IN_USE",
  "created": "2025-08-02T16:00:00"
}
```

---

### 📄 `GET /device`

Get all devices.

**Response:** `List<DeviceDTO>`

---

### 🔍 `GET /device/brand/{brand}`

Get all devices by brand name.

```http
GET /device/brand/Siemens
```

---

### 🔍 `GET /device/state/{state}`

Get all devices by state.

```http
GET /device/state/AVAILABLE
```

---

### ❌ `DELETE /device/{id}`

Delete a device.

* Fails with **409 Conflict** if the device is `IN_USE`.

**Success:**

```http
204 No Content
```

**Failure:**

```json
{
  "timestamp": "2025-08-02T20:22:33.005",
  "status": 409,
  "error": "Conflict",
  "message": "Cannot delete a device that is in use."
}
```

---

## ❗ Error Handling

The API returns structured error responses:

```json
{
  "timestamp": "2025-08-02T20:00:00",
  "status": 400,
  "error": "Bad Request",
  "message": "Unknown brand: MarsTech"
}
```
